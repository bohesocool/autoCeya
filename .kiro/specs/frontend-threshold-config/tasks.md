# 实现计划

- [x] 1. 修改 docker-compose.yml 配置





  - [x] 1.1 更新环境变量配置，使用 `${VAR:-default}` 语法读取 .env 文件


    - 将 `DEFAULT_SUCCESS_THRESHOLD=80` 改为 `${DEFAULT_SUCCESS_THRESHOLD:-75}`
    - 将 `DEFAULT_MAX_FAILURES=10` 改为 `${DEFAULT_MAX_FAILURES:-20}`
    - 将 `DEFAULT_RESPONSE_TIME_THRESHOLD=150000` 改为 `${DEFAULT_RESPONSE_TIME_THRESHOLD:-150000}`
    - _需求: 4.1, 4.2, 4.3, 4.4_

- [x] 2. 扩展后端参数验证





  - [x] 2.1 修改 src/middlewares/validator.js，添加阈值参数验证


    - 验证 successThreshold 在 0-100 范围内
    - 验证 maxFailures 为非负整数
    - 仅在自动模式下验证这些参数
    - _需求: 6.1, 6.2, 6.3_
  - [x] 2.2 编写属性测试：成功率阈值范围验证






    - **Property 3: 成功率阈值范围验证**
    - **验证: 需求 2.2, 6.1**
  - [x] 2.3 编写属性测试：最大失败次数验证






    - **Property 4: 最大失败次数验证**
    - **验证: 需求 2.3, 6.2**

- [x] 3. 修改测压服务支持动态阈值





  - [x] 3.1 修改 src/services/stressTestService.js 的 start 方法


    - 在 testState 中添加 thresholds 对象
    - 使用前端传递的值，未传递时使用环境变量默认值
    - _需求: 3.1, 3.2, 3.3_
  - [x] 3.2 修改 checkOverload 方法支持阈值为0时跳过判定


    - 成功率阈值为0时跳过成功率判定
    - 最大连续失败次数为0时跳过连续失败判定
    - _需求: 1.3, 1.4, 3.4_
  - [x] 3.3 编写属性测试：阈值为0时跳过判定






    - **Property 1: 阈值为0时跳过判定**
    - **验证: 需求 1.3**
  - [x] 3.4 编写属性测试：连续失败阈值为0时跳过判定






    - **Property 2: 连续失败阈值为0时跳过判定**
    - **验证: 需求 1.4**
  - [x] 3.5 编写属性测试：前端配置覆盖默认值






    - **Property 5: 前端配置覆盖默认值**
    - **验证: 需求 3.2**
  - [x] 3.6 编写属性测试：未传递参数时使用默认值






    - **Property 6: 未传递参数时使用默认值**
    - **验证: 需求 3.3**
  - [x] 3.7 编写属性测试：过载检测使用配置阈值






    - **Property 7: 过载检测使用配置阈值**
    - **验证: 需求 3.4**

- [x] 4. 检查点 - 确保所有测试通过





  - 确保所有测试通过，如有问题请询问用户

- [x] 5. 修改前端界面





  - [x] 5.1 在 public/dashboard.html 中添加阈值配置UI


    - 在自动测压模式配置区域添加成功率阈值输入框
    - 添加最大连续失败次数输入框
    - 添加说明文字，标注"0表示不判定"
    - _需求: 1.1, 5.1, 5.2_

  - [x] 5.2 实现模式切换时的显示/隐藏逻辑

    - 自动测压模式显示阈值配置
    - 固定测压模式隐藏阈值配置
    - _需求: 1.1, 1.2, 5.3_

  - [x] 5.3 实现前端输入验证

    - 验证成功率阈值在0-100范围内
    - 验证最大连续失败次数为非负整数
    - 无效输入时显示错误提示
    - _需求: 2.2, 2.3, 2.4_
  - [x] 5.4 实现配置持久化到 localStorage


    - 保存阈值配置到 localStorage
    - 页面加载时恢复配置
    - _需求: 1.5, 2.1_
  - [x] 5.5 修改启动测试函数，发送阈值参数到后端


    - 在自动模式下将阈值参数添加到请求体
    - _需求: 3.1_

- [x] 6. 最终检查点 - 确保所有测试通过





  - 确保所有测试通过，如有问题请询问用户
