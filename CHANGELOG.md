# 更新日志

## [改进优化] 2025-11-05 v2

### ⏱️ 总运行时间显示
- ✅ 将"本分钟已运行"改为"总共运行时间"
- ✅ 显示格式为"时:分:秒"（HH:MM:SS）
- ✅ 基于服务器端的startTime计算，重新打开页面不会重置
- ✅ 更方便查看整轮测试运行了多久

### 📈 曲线图更新优化
- ✅ 使用独立定时器每60秒准时记录统计数据
- ✅ 解决了之前依赖请求完成才更新导致的延迟问题
- ✅ 曲线图现在可以准时更新，不再延迟一两分钟
- ✅ 提升数据可视化的实时性和准确性

### 📝 后台日志完善
- ✅ **开始测压日志**：显示测试配置（模式、RPM、语句模式、请求类型、模型名、URL等）
- ✅ **每分钟小总结**：自动输出当前RPM、本分钟请求数、成功/失败统计、成功率
- ✅ **停止测试大总结**：显示运行时长、请求统计、成功率、平均响应时间、主要错误类型
- ✅ **不记录每条请求**：避免日志过大，只在关键节点输出信息
- ✅ 使用美观的边框和图标，便于阅读

### 🔧 技术改进
- ✅ 重构定时器管理，使用全局timers对象统一管理
- ✅ 添加clearAllTimers()函数，确保所有定时器正确清理
- ✅ 分离recordMinuteStats()函数，由独立定时器调用
- ✅ 添加printFinalSummary()函数，输出详细的测试总结

---

## [新功能] 2025-11-05 v1

### ✨ 配置记忆功能
- ✅ 启动测试时自动保存所有配置信息
- ✅ 重新打开页面自动加载上次的配置
- ✅ 保存内容包括：URL、模型名、API密钥、测试语句、RPM设置、测试模式等
- ✅ 使用浏览器localStorage实现，无需服务器存储

### 🔄 后台持续运行
- ✅ 测压任务在服务器后台运行
- ✅ 关闭浏览器窗口不影响测试进行
- ✅ 重新打开页面立即恢复测试状态
- ✅ WebSocket自动重连机制
- ✅ 在界面添加明显提示说明此功能

### 📊 完整历史数据显示
- ✅ 移除了60分钟的数据限制
- ✅ 现在可以保留最多24小时（1440分钟）的历史数据
- ✅ 曲线图智能调整X轴密度
- ✅ 优化图表性能，支持大量数据点
- ✅ 改进tooltip显示，包含更多详细信息
- ✅ 小号数据点，减少视觉混乱

### 🎨 界面优化
- ✅ 添加醒目的功能提示横幅
- ✅ 优化图表交互体验
- ✅ 改进数据点显示效果

### 📝 文档更新
- ✅ 更新README说明所有新功能
- ✅ 添加使用指南
- ✅ 说明配置记忆和后台运行特性

---

## 技术细节

### 前端改进
- 新增 `saveConfig()` 函数：保存配置到localStorage
- 新增 `loadSavedConfig()` 函数：从localStorage恢复配置
- 优化Chart.js配置，提升长时间数据展示效果
- 改进tooltip显示逻辑，增加成功率计算

### 后端改进
- `checkMinuteStats()` 函数：数据保留限制从60分钟提升到1440分钟
- 确保测压任务独立运行，不依赖WebSocket连接
- 优化内存管理，支持长时间运行

### 用户体验提升
- 配置无需重复输入，节省时间
- 可以自由关闭/打开页面，不影响测试
- 完整的历史数据可视化，便于分析长期趋势
- 直观的提示信息，明确说明后台运行特性

