# ğŸ”§ Swagger API æ–‡æ¡£ä¿®å¤è¯´æ˜

## é—®é¢˜

è®¿é—® `http://localhost:8998/api-docs` è¿”å› 404 é”™è¯¯ã€‚

## åŸå› 

1. **æ¡ä»¶ç¦ç”¨é—®é¢˜**ï¼šSwagger é»˜è®¤åœ¨ç”Ÿäº§ç¯å¢ƒè¢«ç¦ç”¨
2. **è·¯å¾„é…ç½®é—®é¢˜**ï¼šswagger-jsdoc å¯èƒ½æ— æ³•æ‰¾åˆ°è·¯ç”±æ–‡ä»¶

## âœ… å·²ä¿®å¤

### 1. æ”¹ä¸ºé»˜è®¤å¯ç”¨

**ä¿®æ”¹æ–‡ä»¶**ï¼š`server-new.js`

```javascript
// æ—§ç‰ˆï¼ˆä¼šåœ¨ç”Ÿäº§ç¯å¢ƒç¦ç”¨ï¼‰
if (config.nodeEnv !== 'production' || process.env.ENABLE_API_DOCS === 'true') {
  setupSwagger(app);
}

// æ–°ç‰ˆï¼ˆé»˜è®¤å¯ç”¨ï¼‰
if (process.env.DISABLE_API_DOCS !== 'true') {
  setupSwagger(app);
}
```

### 2. æ”¹è¿›è·¯å¾„é…ç½®

**ä¿®æ”¹æ–‡ä»¶**ï¼š`src/swagger.js`

```javascript
apis: [
  './src/routes/*.js',  // ä¸»è·¯å¾„
  'src/routes/*.js',    // å¤‡ç”¨è·¯å¾„
]
```

### 3. æ·»åŠ è¯¦ç»†æ—¥å¿—

ç°åœ¨å¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºï¼š
```
Swagger specsç”ŸæˆæˆåŠŸï¼Œæ‰¾åˆ°çš„APIæ•°é‡: 8
âœ“ Swagger UI å·²æˆåŠŸæŒ‚è½½åˆ° /api-docs
Swagger API æ–‡æ¡£å·²å¯ç”¨: /api-docs
```

## ğŸš€ é‡å¯æœåŠ¡å™¨

**é‡è¦**ï¼šå¿…é¡»é‡å¯æœåŠ¡å™¨æ‰èƒ½ç”Ÿæ•ˆï¼

```bash
# 1. åœæ­¢æœåŠ¡å™¨ï¼ˆCtrl+Cï¼‰
# ç°åœ¨åº”è¯¥å¯ä»¥æ­£å¸¸å…³é—­äº†

# 2. é‡æ–°å¯åŠ¨
npm start

# 3. æŸ¥çœ‹æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
# âœ“ Swagger UI å·²æˆåŠŸæŒ‚è½½åˆ° /api-docs
# Swagger API æ–‡æ¡£å·²å¯ç”¨: /api-docs
```

## ğŸ“– è®¿é—® API æ–‡æ¡£

å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®ï¼š

```
http://localhost:8998/api-docs
```

åº”è¯¥çœ‹åˆ° Swagger UI ç•Œé¢ï¼ŒåŒ…å«æ‰€æœ‰ API ç«¯ç‚¹çš„æ–‡æ¡£ã€‚

## ğŸ› å¦‚æœè¿˜æ˜¯404

### æ£€æŸ¥1ï¼šæŸ¥çœ‹å¯åŠ¨æ—¥å¿—

```bash
npm start
```

**æœŸæœ›çœ‹åˆ°**ï¼š
```
âœ“ Swagger UI å·²æˆåŠŸæŒ‚è½½åˆ° /api-docs
Swagger API æ–‡æ¡£å·²å¯ç”¨: /api-docs
```

**å¦‚æœçœ‹åˆ°é”™è¯¯**ï¼š
```
âœ— Swaggeråˆå§‹åŒ–å¤±è´¥: ...
```

### æ£€æŸ¥2ï¼šéªŒè¯ä¾èµ–

```bash
npm list swagger-jsdoc swagger-ui-express
```

**æœŸæœ›è¾“å‡º**ï¼š
```
â”œâ”€â”€ swagger-jsdoc@6.2.8
â””â”€â”€ swagger-ui-express@5.0.0
```

**å¦‚æœç¼ºå°‘ä¾èµ–**ï¼š
```bash
npm install
```

### æ£€æŸ¥3ï¼šæ‰‹åŠ¨æµ‹è¯•è·¯ç”±

```bash
curl http://localhost:8998/api-docs
```

**æ­£å¸¸æƒ…å†µ**ï¼šè¿”å› HTML é¡µé¢

**404æƒ…å†µ**ï¼šæ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦çœŸçš„é‡å¯äº†

### æ£€æŸ¥4ï¼šè·¯å¾„é—®é¢˜

ç¡®è®¤é¡¹ç›®ç»“æ„ï¼š
```
autoCeya/
â”œâ”€â”€ server-new.js
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ swagger.js
â”‚   â””â”€â”€ routes/
â”‚       â”œâ”€â”€ auth.js
â”‚       â”œâ”€â”€ test.js
â”‚       â””â”€â”€ history.js
```

## ğŸ’¡ ä¸´æ—¶ç¦ç”¨ Swagger

å¦‚æœç¡®å®ä¸éœ€è¦ API æ–‡æ¡£ï¼Œå¯ä»¥ç¦ç”¨ï¼š

```bash
# åœ¨ .env ä¸­æ·»åŠ 
DISABLE_API_DOCS=true
```

## ğŸ¯ éªŒè¯ Swagger å·¥ä½œæ­£å¸¸

è®¿é—® `http://localhost:8998/api-docs`ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

### é¡¶éƒ¨
```
AutoCeya API æ–‡æ¡£
v2.0.0
AIæ¨¡å‹è‡ªåŠ¨æµ‹å‹ç³»ç»Ÿ API æ¥å£æ–‡æ¡£
```

### API åˆ†ç±»
- **è®¤è¯** - ç™»å½•æ¥å£
- **æµ‹å‹** - å¯åŠ¨ã€åœæ­¢ã€çŠ¶æ€ç­‰
- **å†å²è®°å½•** - æŸ¥è¯¢ã€åˆ é™¤ç­‰

### æ¯ä¸ªæ¥å£åŒ…å«
- è¯·æ±‚å‚æ•°è¯´æ˜
- å“åº”æ ¼å¼ç¤ºä¾‹
- Try it out æŒ‰é’®ï¼ˆå¯ä»¥ç›´æ¥æµ‹è¯•ï¼‰

## ğŸ“ è¿˜æœ‰é—®é¢˜ï¼Ÿ

å¦‚æœé‡å¯åè¿˜æ˜¯404ï¼š

1. **æ£€æŸ¥ç«¯å£**ï¼šç¡®è®¤æ˜¯ 8998 ç«¯å£
2. **æ£€æŸ¥è¿›ç¨‹**ï¼šç¡®è®¤æ—§è¿›ç¨‹å·²ç»å®Œå…¨åœæ­¢
   ```bash
   # Windows
   netstat -ano | findstr :8998
   
   # å¦‚æœæœ‰è¿›ç¨‹ï¼Œkill å®ƒ
   taskkill /PID <è¿›ç¨‹ID> /F
   ```
3. **æ¸…é™¤ç¼“å­˜**ï¼š
   ```bash
   rm -rf node_modules package-lock.json
   npm install
   npm start
   ```

---

**ç°åœ¨è¯·é‡å¯æœåŠ¡å™¨æµ‹è¯•ï¼** ğŸš€

